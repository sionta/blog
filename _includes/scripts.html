{%- assign vendor_js = '/assets/js/vendor' | relative_url -%}
{%- if page.collection == 'posts' or page.layout == 'post' -%}
  {% include comments.html %}
  {%- if page.toc == true or page.table_of_content == true -%}
    <script type="text/javascript" src="{{- vendor_js -}}/tocbot.min.js"></script>
    <script type="text/javascript">
      document.addEventListener('DOMContentLoaded', function () {
        tocbot.init({
          tocSelector: '#toc',
          contentSelector: '[itemprop="articleBody"]',
          ignoreSelector: '.no_toc',
          headingSelector: 'h2, h3, h4',
          orderedList: false,
          scrollSmooth: true,
          scrollSmoothOffset: -100,
        });
        tocbot.refresh();
      });
    </script>
  {%- endif -%}
  {%- if page.mermaid == true or page.diagram == true -%}
    <script type="text/javascript" src="{{- vendor_js -}}/mermaid.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        // Select all Mermaid code elements
        const mermaidElements = document.querySelectorAll('.language-mermaid');

        mermaidElements.forEach((codeElement) => {
          // Create a new pre element with the 'mermaid' class
          const pre = document.createElement('pre');
          pre.classList.add('mermaid');
          pre.innerHTML = codeElement.textContent;

          // Replace the original element with the new pre element
          codeElement.parentElement.replaceWith(pre);
        });

        // Initialize Mermaid
        mermaid.initialize({ startOnLoad: true });
      });
    </script>
  {%- endif -%}
{%- endif -%}
