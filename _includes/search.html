<div class="site-search">
  <label for="search-input">
    <!-- prettier-ignore -->
    <input id="search-input" type="search" autocomplete="off" spellcheck="false" placeholder="Search blog posts..">
  </label>
  <div class="result-container">
    <ul id="search-results"></ul>
  </div>
</div>
<script src="https://unpkg.com/simple-jekyll-search@latest/dest/simple-jekyll-search.min.js"></script>
<script>
  const searchInput = document.getElementById('search-input');
  const searchResults = document.getElementById('search-results');
  const resultTemplate = `
  <div class="search-item">
    <a class="search-link" href="{url}">{title}</a>
  </div>
  `;

  window.SimpleJekyllSearch({
    searchInput: searchInput,
    resultsContainer: searchResults,
    searchResultTemplate: resultTemplate,
    json: [{%- for post in site.posts %}
      {
        "title"    : "{{- post.title | escape -}}",
        "excerpt"  : "{{- post.excerpt | strip_html | strip_newlines | escape -}}",
        "category" : "{{- post.categories | join: ', ' -}}",
        "tags"     : "{{- post.tags | join: ', ' -}}",
        "url"      : "{{- post.url | relative_url -}}",
        "date"     : "{{- post.date | date: '%b %d %Y' -}}",
        "description"     : "{{- post.description -}}"
      }{% unless forloop.last %},{% endunless %}{%- endfor %}
    ],
    noResultsText: '',
    limit: 10,
    fuzzy: false,
  });

  searchInput.addEventListener('input', () => {
    const searchTerm = searchInput.value;
    if (searchTerm === '') {
      searchResults.innerHTML = '';
    } else if (searchResults.innerHTML.trim() === '') {
      searchResults.innerHTML = `<div class="no-results"><span>No results for</span> <span>"${searchTerm}</span>"</div>`;
    }
  });
</script>
