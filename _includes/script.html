<script src="{{- '/assets/js/main.js' | relative_url -}}"></script>
{% assign vendor_js = '/assets/js/vendor' | relative_url %}

{% if page.collection == 'posts' or page.layout == 'post' %}
  {% include comments.html %}

  {% if page.anchor == true or page.anchor_headings == true %}
    <script type="text/javascript">
      document.addEventListener('DOMContentLoaded', function () {
        let headings = document.querySelectorAll('h2, h3, h4');
        let ignores = ['no_toc', 'no_anchor'];
        headings.forEach(function (heading) {
          if (!ignores.some((className) => heading.classList.contains(className))) {
            let anchor = document.createElement('a');
            anchor.setAttribute('href', '#' + heading.id);
            anchor.setAttribute('class', 'anchor-link');
            anchor.innerHTML = '#';
            heading.appendChild(anchor);
          }
        });
      });
    </script>
  {% endif %}

  {% if page.mermaid == true or page.diagram == true %}
    <script type="text/javascript" src="{{- vendor_js -}}/mermaid.min.js"></script>
    <script type="text/javascript">
      document.addEventListener('DOMContentLoaded', () => {
        mermaid.initialize({
          startOnLoad: true,
          theme: 'default',
          securityLevel: 'loose',
        });
        let mermaidClass = document.getElementsByClassName('language-mermaid');
        Array.from(mermaidClass).forEach((element) => {
          element.classList.add('mermaid');
          mermaid.init(undefined, element);
        });
      });
    </script>
  {% endif %}
{% endif %}
